import seaborn as sns
from matplotlib import pyplot as plt
import pandas as pd
from sklearn.manifold import TSNE
import numpy as np
import warnings
warnings.filterwarnings('ignore')

def plot_tsne(zs, label, title, save=None):
    tsne = TSNE(n_components=2, init='pca',learning_rate='auto')

    sub_graph_num = len(zs)
    fig, ax = plt.subplots(1,sub_graph_num, figsize=(10, 3.5))

    class_num = max(label)+1
    palette = sns.color_palette("bright", class_num)
    for i in range(sub_graph_num):
        data = tsne.fit_transform(zs[i])
        x_min, x_max = np.min(data, 0), np.max(data, 0)
        data = (data - x_min) / (x_max - x_min)
        sns.scatterplot(data[:,0], data[:,1], ax=ax[i], hue=label, palette=palette)
        ax[i].set_title('V'+str(i))

    plt.suptitle(title, fontsize=14)
    #plt.title('tsne in the {} dataset'.format(name))
    # 返回值
    if save:
        plt.savefig(save)
    plt.show()
    return fig


def plot_loss(losses, dim_num=1, save=None, name=None):
    di = {}
    if dim_num == 1:
        se = pd.Series(losses)
        di[0] = se
    else:
        for i in range(len(losses)):
            se = pd.Series(losses[i])
            di[i] = se
    df = pd.DataFrame(di)
    plt.figure(figsize=(12, 6))
    sns.lineplot(data=df)
    plt.title(name)
    if save:
        plt.savefig(save)
    plt.show()



if __name__ == '__main__':
    a = [2.3807873725891113, 2.380815029144287, 2.380840301513672, 2.380863904953003, 2.3808836936950684, 2.3808979988098145, 2.380903482437134, 2.3808937072753906, 2.3808577060699463, 2.380772590637207, 2.380580186843872, 2.3800902366638184, 2.3783323764801025, 2.3641514778137207, 2.3713793754577637, 2.37215256690979, 2.3659982681274414, 2.350057601928711, 2.338813304901123, 2.2959184646606445, 2.2764177322387695, 2.2192840576171875, 2.145049810409546, 2.110853910446167, 2.0317840576171875, 1.8624019622802734, 1.8257777690887451, 1.7876875400543213, 1.7210173606872559, 1.617624282836914, 1.549333095550537, 1.5535484552383423, 1.5436475276947021, 1.5050113201141357, 1.4678664207458496, 1.4547075033187866, 1.460025429725647, 1.4622564315795898, 1.453349232673645, 1.4385414123535156, 1.4254159927368164, 1.4185913801193237, 1.4163906574249268, 1.4138383865356445, 1.4093468189239502, 1.4042770862579346, 1.3986263275146484, 1.3917217254638672, 1.3841571807861328, 1.379274606704712, 1.3783406019210815, 1.3756070137023926, 1.3687222003936768, 1.3640912771224976, 1.35947847366333, 1.35337233543396, 1.3499630689620972, 1.3541125059127808, 1.4072736501693726, 1.5116009712219238, 1.4279314279556274, 1.4423335790634155, 1.3400108814239502, 1.375002145767212, 1.3709683418273926, 1.33956778049469, 1.3663313388824463, 1.3445649147033691, 1.3442580699920654, 1.3736708164215088, 1.462395429611206, 1.3468024730682373, 1.479739785194397, 1.424617886543274, 1.4140660762786865, 1.3979682922363281, 1.3845858573913574, 1.4070055484771729, 1.366223931312561, 1.3467456102371216, 1.3762564659118652, 1.3392131328582764, 1.338788390159607, 1.350409746170044, 1.3485206365585327, 1.3310664892196655, 1.325312852859497, 1.3365874290466309, 1.329092025756836, 1.3218375444412231, 1.3228312730789185, 1.3266016244888306, 1.321347713470459, 1.3169519901275635, 1.3198435306549072, 1.330967664718628, 1.354891061782837, 1.3667266368865967, 1.3517121076583862, 1.348407506942749, 1.3394997119903564, 1.3270115852355957, 1.331113338470459, 1.3255300521850586, 1.3191022872924805, 1.3198785781860352, 1.3157484531402588, 1.3117386102676392, 1.3125202655792236, 1.3076636791229248, 1.308739423751831, 1.3058550357818604, 1.304351806640625, 1.3046627044677734, 1.300675392150879, 1.302980899810791, 1.2985024452209473, 1.300116777420044, 1.2983380556106567, 1.297497272491455, 1.2973644733428955, 1.297203779220581, 1.2989356517791748, 1.3072435855865479, 1.355860710144043, 1.5989927053451538, 1.6193790435791016, 1.4194190502166748, 1.553227424621582, 1.5042164325714111, 1.4896786212921143, 1.4855196475982666, 1.4622079133987427, 1.4690184593200684, 1.3589131832122803, 1.4361863136291504, 1.400979995727539, 1.395097017288208, 1.3498659133911133, 1.3842217922210693, 1.3718713521957397, 1.3869320154190063, 1.370986819267273, 1.35834538936615, 1.3526217937469482, 1.3411489725112915, 1.35166335105896, 1.3479037284851074, 1.3395695686340332, 1.3353462219238281, 1.3328278064727783, 1.3346936702728271, 1.3302223682403564, 1.3259484767913818, 1.323897361755371, 1.319882869720459, 1.3212414979934692, 1.3160005807876587, 1.3152310848236084, 1.3141820430755615, 1.313863754272461, 1.3115761280059814, 1.3088481426239014, 1.3098267316818237, 1.3080023527145386, 1.3053396940231323, 1.3054170608520508, 1.304589033126831, 1.3019740581512451, 1.3013577461242676, 1.3000943660736084, 1.2982903718948364, 1.297741174697876, 1.2964012622833252, 1.2958636283874512, 1.2976478338241577, 1.3067587614059448, 1.3580139875411987, 1.357529640197754, 1.3715535402297974, 1.2921937704086304, 1.3678958415985107, 1.358856201171875, 1.3270697593688965, 1.345710039138794, 1.3069617748260498, 1.3216869831085205, 1.3285977840423584, 1.3053786754608154, 1.325857400894165, 1.3018090724945068, 1.2966890335083008, 1.3025565147399902, 1.2956953048706055, 1.2956326007843018, 1.3029035329818726, 1.3096981048583984, 1.3049763441085815, 1.3420032262802124, 1.3030450344085693, 1.3188689947128296, 1.3705323934555054, 1.312148094177246, 1.3872965574264526, 1.322460651397705, 1.3510278463363647, 1.3125243186950684, 1.3303982019424438, 1.3092594146728516, 1.3119280338287354, 1.3105422258377075, 1.3056005239486694, 1.2982978820800781, 1.305314302444458, 1.2959327697753906, 1.2955458164215088, 1.2981325387954712, 1.2929452657699585, 1.289217472076416, 1.2936108112335205, 1.2875797748565674, 1.2876904010772705, 1.2889175415039062, 1.2848000526428223, 1.2852659225463867, 1.2849059104919434, 1.282472848892212, 1.2841296195983887, 1.280989170074463, 1.2839120626449585, 1.293167233467102, 1.3534109592437744, 1.4044291973114014, 1.3192353248596191, 1.28566575050354, 1.340977430343628, 1.293029546737671, 1.3023039102554321, 1.2950336933135986, 1.2916100025177002, 1.2958571910858154, 1.327980399131775, 1.4648208618164062, 1.3530960083007812, 1.5184338092803955, 1.3988516330718994, 1.4180686473846436, 1.4528731107711792, 1.3433082103729248, 1.364048957824707, 1.3723843097686768, 1.3136298656463623, 1.347053050994873, 1.3540539741516113, 1.3336317539215088, 1.3172940015792847, 1.320860505104065, 1.3283324241638184, 1.3150029182434082, 1.306602954864502, 1.3147709369659424, 1.3136295080184937, 1.3069747686386108, 1.304352879524231, 1.3020187616348267, 1.3020625114440918, 1.29764723777771, 1.2950003147125244, 1.2970554828643799, 1.2958401441574097, 1.2932623624801636, 1.290608286857605, 1.2935327291488647, 1.2931033372879028, 1.3026002645492554, 1.3370537757873535, 1.3705397844314575, 1.3094418048858643, 1.3161499500274658, 1.3515056371688843, 1.2847527265548706, 1.3282151222229004, 1.330061435699463, 1.2954989671707153, 1.333099126815796, 1.2892204523086548, 1.3076376914978027, 1.2907028198242188, 1.2956031560897827, 1.2904975414276123, 1.2851594686508179, 1.292562484741211, 1.2760636806488037, 1.2905725240707397, 1.2780009508132935, 1.2844759225845337, 1.2784078121185303, 1.2773561477661133, 1.2814936637878418, 1.2876787185668945, 1.290292739868164, 1.316723346710205, 1.287961721420288, 1.3547167778015137, 1.4113210439682007, 1.4055681228637695, 1.2767525911331177, 1.4859488010406494, 1.3109028339385986, 1.3420673608779907, 1.3753383159637451, 1.3328967094421387, 1.2918097972869873, 1.3450262546539307, 1.3122469186782837, 1.296634554862976, 1.314445972442627, 1.3210151195526123, 1.3114769458770752, 1.295237421989441, 1.290635585784912, 1.3055953979492188, 1.2943511009216309, 1.2876031398773193, 1.2916942834854126, 1.2972795963287354, 1.3048453330993652, 1.324113130569458, 1.3749239444732666, 1.3243730068206787, 1.2846976518630981, 1.2886500358581543, 1.3098981380462646, 1.2933387756347656, 1.2793176174163818, 1.2921723127365112, 1.2851123809814453, 1.2797480821609497, 1.2852168083190918, 1.2778774499893188, 1.2804416418075562, 1.277188777923584, 1.2758727073669434, 1.277000069618225, 1.2730772495269775, 1.2753753662109375, 1.2725450992584229, 1.2723510265350342, 1.272794246673584, 1.2704869508743286, 1.2701143026351929, 1.271848201751709, 1.268338918685913, 1.269625186920166, 1.2703732252120972, 1.2689735889434814, 1.273972749710083, 1.2902867794036865, 1.3290295600891113, 1.2905478477478027, 1.2773689031600952, 1.3093899488449097, 1.381171464920044, 1.383755087852478, 1.3787264823913574, 1.3470884561538696, 1.322878360748291, 1.3578877449035645, 1.2952830791473389, 1.3478195667266846, 1.300058126449585, 1.31626296043396, 1.2950365543365479, 1.3025882244110107, 1.2941598892211914, 1.2899250984191895, 1.2932155132293701, 1.2817879915237427, 1.2893991470336914, 1.2777791023254395, 1.2839841842651367, 1.278784990310669, 1.2769763469696045, 1.2776145935058594, 1.275930404663086, 1.2732332944869995, 1.275404453277588, 1.270124912261963, 1.2742092609405518, 1.2703475952148438, 1.2700979709625244, 1.2706279754638672, 1.2691545486450195, 1.2670879364013672, 1.2695848941802979, 1.2680127620697021, 1.2660529613494873, 1.2660927772521973, 1.2678232192993164, 1.269732117652893, 1.274415373802185, 1.2817661762237549, 1.3121528625488281, 1.3102344274520874, 1.3148014545440674, 1.339721441268921, 1.3177013397216797, 1.2865159511566162, 1.3161228895187378, 1.300689458847046, 1.338244915008545, 1.37614107131958, 1.3508775234222412, 1.277722716331482, 1.3059719800949097, 1.3226451873779297, 1.2758967876434326, 1.3153620958328247, 1.2829169034957886, 1.292433500289917, 1.282443642616272, 1.2817440032958984, 1.2808473110198975, 1.279091477394104, 1.2747554779052734, 1.2772636413574219, 1.2716035842895508, 1.2751350402832031, 1.269435167312622, 1.2723214626312256, 1.2688710689544678, 1.268678903579712, 1.2696349620819092, 1.2679191827774048, 1.2671277523040771, 1.2661635875701904, 1.2673276662826538, 1.2681739330291748, 1.2723336219787598, 1.2822792530059814, 1.2883074283599854, 1.309907078742981, 1.2764277458190918, 1.2814223766326904, 1.3089821338653564, 1.2868423461914062, 1.3093290328979492, 1.3166992664337158, 1.3158535957336426, 1.2757093906402588, 1.3556092977523804, 1.3436110019683838, 1.3749016523361206]
    b =  [1.3885676860809326, 1.388023853302002, 1.3875062465667725, 1.3870153427124023, 1.3865506649017334, 1.386107325553894, 1.3856828212738037, 1.3852767944335938, 1.3848881721496582, 1.384516954421997, 1.3841629028320312, 1.3838248252868652, 1.3835026025772095, 1.3831942081451416, 1.3829079866409302, 1.382625699043274, 1.382361650466919, 1.3821132183074951, 1.381872296333313, 1.381648302078247, 1.3814356327056885, 1.3812339305877686, 1.3810445070266724, 1.3808708190917969, 1.3807034492492676, 1.3805456161499023, 1.3804001808166504, 1.3802664279937744, 1.3801406621932983, 1.380023717880249, 1.379916787147522, 1.3798201084136963, 1.3797330856323242, 1.3796544075012207, 1.3795832395553589, 1.3795191049575806, 1.3794622421264648, 1.3794127702713013, 1.3793702125549316, 1.379333734512329, 1.3793028593063354, 1.3792766332626343, 1.3792544603347778, 1.3792365789413452, 1.379223108291626, 1.3792136907577515, 1.3792085647583008, 1.379207730293274, 1.3792109489440918, 1.379217505455017, 1.3792270421981812, 1.379239559173584, 1.3792545795440674, 1.3792729377746582, 1.379293441772461, 1.3793160915374756, 1.3793401718139648, 1.3793668746948242, 1.379394769668579, 1.3794262409210205, 1.3794569969177246, 1.379488229751587, 1.3795228004455566, 1.379558801651001, 1.3795952796936035, 1.3796324729919434, 1.3796703815460205, 1.3797096014022827, 1.3797495365142822, 1.3797898292541504, 1.379832148551941, 1.3798720836639404, 1.379913330078125, 1.3799564838409424, 1.3799982070922852, 1.3800394535064697, 1.380082130432129, 1.380124807357788, 1.3801664113998413, 1.3802073001861572, 1.3802480697631836, 1.3802891969680786, 1.3803300857543945, 1.3803703784942627, 1.3804099559783936, 1.380448579788208, 1.3804867267608643, 1.3805243968963623, 1.3805618286132812, 1.380598545074463, 1.3806350231170654, 1.3806706666946411, 1.3807055950164795, 1.3807392120361328, 1.3807724714279175, 1.3808050155639648, 1.3808369636535645, 1.3808683156967163, 1.3808985948562622, 1.3809281587600708, 1.380957007408142, 1.380984902381897, 1.381011962890625, 1.3810385465621948, 1.3810641765594482, 1.3810889720916748, 1.3811129331588745, 1.381136178970337, 1.3811585903167725, 1.3811802864074707, 1.3812012672424316, 1.3812215328216553, 1.3812410831451416, 1.3812599182128906, 1.381278157234192, 1.3812956809997559, 1.3813124895095825, 1.381328821182251, 1.3813443183898926, 1.3813594579696655, 1.3813738822937012, 1.3813878297805786, 1.3814011812210083, 1.3814140558242798, 1.3814263343811035, 1.3814384937286377, 1.3814499378204346, 1.3814606666564941, 1.381471037864685, 1.3814811706542969, 1.3814911842346191, 1.381500244140625, 1.3815093040466309, 1.3815178871154785, 1.3815258741378784, 1.3815336227416992, 1.3815412521362305, 1.3815486431121826, 1.3815555572509766, 1.3815622329711914, 1.3815689086914062, 1.381575107574463, 1.3815810680389404, 1.3815865516662598, 1.381592035293579, 1.3815975189208984, 1.3816025257110596, 1.3816074132919312, 1.3816120624542236, 1.3816165924072266, 1.3816208839416504, 1.3816251754760742, 1.381629228591919, 1.3816330432891846, 1.3816367387771606, 1.3816404342651367, 1.3816437721252441, 1.3816472291946411, 1.381650447845459, 1.3816535472869873, 1.3816564083099365, 1.3816593885421753, 1.381662130355835, 1.381664752960205, 1.3816673755645752, 1.3816698789596558, 1.3816721439361572, 1.3816745281219482, 1.3816767930984497, 1.3816790580749512, 1.3816810846328735, 1.3816829919815063, 1.3816848993301392, 1.381686806678772, 1.3816885948181152, 1.381690263748169, 1.3816919326782227, 1.3816934823989868, 1.381695032119751, 1.3816965818405151, 1.3816978931427002, 1.3816993236541748, 1.3817006349563599, 1.381701946258545, 1.3817031383514404, 1.3817042112350464, 1.3817055225372314, 1.3817065954208374, 1.3817075490951538, 1.3817086219787598, 1.3817095756530762, 1.3817105293273926, 1.3817113637924194, 1.3817121982574463, 1.3817129135131836, 1.3817138671875, 1.3817145824432373, 1.3817152976989746, 1.381716012954712, 1.3817167282104492, 1.3817172050476074, 1.3817179203033447, 1.381718397140503, 1.3817191123962402, 1.3817195892333984, 1.3817200660705566, 1.3817205429077148, 1.381721019744873, 1.3817214965820312, 1.3817219734191895, 1.3817222118377686, 1.3817226886749268, 1.3817230463027954, 1.381723403930664, 1.3817237615585327, 1.3817241191864014, 1.3817243576049805, 1.3817247152328491, 1.3817250728607178, 1.3817250728607178, 1.381725549697876, 1.381725788116455, 1.3817260265350342, 1.3817261457443237, 1.3817265033721924, 1.381726622581482, 1.3817267417907715, 1.3817269802093506, 1.3817272186279297, 1.3817274570465088, 1.3817274570465088, 1.381727695465088, 1.3817278146743774, 1.381727933883667, 1.3817280530929565, 1.381728172302246, 1.3817282915115356, 1.3817284107208252, 1.3817285299301147, 1.3817286491394043, 1.3817286491394043, 1.3817288875579834, 1.3817288875579834, 1.381729006767273, 1.3817291259765625, 1.3817291259765625, 1.3817293643951416, 1.3817293643951416, 1.3817293643951416, 1.3817294836044312, 1.3817294836044312, 1.3817296028137207, 1.3817296028137207, 1.3817296028137207, 1.3817297220230103, 1.3817297220230103, 1.3817298412322998, 1.3817298412322998, 1.3817299604415894, 1.3817299604415894, 1.3817299604415894, 1.381730079650879, 1.381730079650879, 1.381730079650879, 1.381730079650879, 1.381730079650879, 1.381730079650879, 1.381730079650879, 1.3817301988601685, 1.381730318069458, 1.381730318069458, 1.381730318069458, 1.381730318069458, 1.381730318069458, 1.381730318069458, 1.381730318069458, 1.381730318069458, 1.381730318069458, 1.381730318069458, 1.381730318069458, 1.381730318069458, 1.381730318069458, 1.3817304372787476, 1.3817304372787476, 1.3817304372787476, 1.3817304372787476, 1.3817304372787476, 1.3817304372787476, 1.3817304372787476, 1.381730556488037, 1.381730556488037, 1.381730556488037, 1.381730556488037, 1.381730556488037, 1.381730556488037, 1.381730556488037, 1.381730556488037, 1.381730556488037, 1.381730556488037, 1.381730556488037, 1.381730556488037, 1.381730556488037, 1.381730556488037, 1.381730556488037, 1.381730556488037, 1.381730556488037, 1.381730556488037, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267, 1.3817306756973267]
    c = [0.41223140495867766, 0.41223140495867766, 0.4175206611570248, 0.4175206611570248, 0.40628099173553717, 0.40628099173553717, 0.40231404958677686, 0.40231404958677686, 0.40396694214876033, 0.40396694214876033, 0.41818181818181815, 0.41818181818181815, 0.4168595041322314, 0.4168595041322314, 0.6538842975206611, 0.6538842975206611, 0.660495867768595, 0.660495867768595, 0.6687603305785124, 0.6687603305785124, 0.7669421487603306, 0.7669421487603306, 0.7596694214876033, 0.7596694214876033, 0.7153719008264463, 0.7153719008264463, 0.6915702479338843, 0.6915702479338843, 0.7778512396694215, 0.7778512396694215, 0.7933884297520661, 0.7933884297520661, 0.80099173553719, 0.80099173553719, 0.8135537190082645, 0.8135537190082645, 0.8224793388429752, 0.8224793388429752, 0.8254545454545454, 0.8254545454545454, 0.827107438016529, 0.827107438016529, 0.8330578512396695, 0.8330578512396695, 0.8396694214876033, 0.8396694214876033, 0.8373553719008264, 0.8373553719008264, 0.8350413223140496, 0.8350413223140496, 0.8383471074380165, 0.8383471074380165, 0.8343801652892562, 0.8343801652892562, 0.8304132231404958, 0.8304132231404958, 0.8343801652892562, 0.8343801652892562, 0.7550413223140496, 0.7550413223140496, 0.7824793388429752, 0.7824793388429752, 0.8175206611570248, 0.8175206611570248, 0.8029752066115703, 0.8029752066115703, 0.7692561983471075, 0.7692561983471075, 0.7880991735537191, 0.7880991735537191, 0.7755371900826447, 0.7755371900826447, 0.7418181818181818, 0.7418181818181818, 0.7973553719008264, 0.7973553719008264, 0.8241322314049587, 0.8241322314049587, 0.7834710743801653, 0.7834710743801653, 0.824793388429752, 0.824793388429752, 0.8370247933884297, 0.8370247933884297, 0.824793388429752, 0.824793388429752, 0.8304132231404958, 0.8304132231404958, 0.8208264462809918, 0.8208264462809918, 0.8386776859504133, 0.8386776859504133, 0.8214876033057851, 0.8214876033057851, 0.8297520661157025, 0.8297520661157025, 0.8373553719008264, 0.8373553719008264, 0.8307438016528925, 0.8307438016528925, 0.828099173553719, 0.828099173553719, 0.8261157024793389, 0.8261157024793389, 0.8307438016528925, 0.8307438016528925, 0.8277685950413223, 0.8277685950413223, 0.8142148760330579, 0.8142148760330579, 0.8211570247933885, 0.8211570247933885, 0.8066115702479338, 0.8066115702479338, 0.8029752066115703, 0.8029752066115703, 0.795702479338843, 0.795702479338843, 0.7976859504132231, 0.7976859504132231, 0.7940495867768596, 0.7940495867768596, 0.7986776859504132, 0.7986776859504132, 0.6578512396694215, 0.6578512396694215, 0.7818181818181819, 0.7818181818181819, 0.736198347107438, 0.736198347107438, 0.7497520661157024, 0.7497520661157024, 0.7980165289256198, 0.7980165289256198, 0.7223140495867768, 0.7223140495867768, 0.7712396694214876, 0.7712396694214876, 0.8132231404958677, 0.8132231404958677, 0.8198347107438017, 0.8198347107438017, 0.8241322314049587, 0.8241322314049587, 0.8056198347107438, 0.8056198347107438, 0.7788429752066116, 0.7788429752066116, 0.80099173553719, 0.80099173553719, 0.816198347107438, 0.816198347107438, 0.8191735537190082, 0.8191735537190082, 0.8085950413223141, 0.8085950413223141, 0.7907438016528926, 0.7907438016528926, 0.807603305785124, 0.807603305785124, 0.8099173553719008, 0.8099173553719008, 0.7811570247933884, 0.7811570247933884, 0.7844628099173554, 0.7844628099173554, 0.8049586776859504, 0.8049586776859504, 0.7709090909090909, 0.7709090909090909, 0.7874380165289256, 0.7874380165289256, 0.7894214876033058, 0.7894214876033058, 0.7160330578512397, 0.7160330578512397, 0.7163636363636363, 0.7163636363636363, 0.7143801652892562, 0.7143801652892562, 0.7110743801652892, 0.7110743801652892, 0.7153719008264463, 0.7153719008264463, 0.7176859504132231, 0.7176859504132231, 0.7229752066115702, 0.7229752066115702, 0.8446280991735537, 0.8446280991735537, 0.7140495867768595, 0.7140495867768595, 0.7110743801652892, 0.7110743801652892, 0.707107438016529, 0.707107438016529, 0.7127272727272728, 0.7127272727272728, 0.7223140495867768, 0.7223140495867768, 0.8684297520661157, 0.8684297520661157, 0.7097520661157025, 0.7097520661157025, 0.872396694214876, 0.872396694214876, 0.6965289256198347, 0.6965289256198347, 0.8674380165289256, 0.8674380165289256, 0.8555371900826446, 0.8555371900826446, 0.7143801652892562, 0.7143801652892562, 0.8396694214876033, 0.8396694214876033, 0.7338842975206612, 0.7338842975206612, 0.7183471074380166, 0.7183471074380166, 0.7305785123966942, 0.7305785123966942, 0.7223140495867768, 0.7223140495867768, 0.715702479338843, 0.715702479338843, 0.7209917355371901, 0.7209917355371901, 0.7137190082644628, 0.7137190082644628, 0.7147107438016529, 0.7147107438016529, 0.7140495867768595, 0.7140495867768595, 0.7140495867768595, 0.7140495867768595, 0.715702479338843, 0.715702479338843, 0.7123966942148761, 0.7123966942148761, 0.7229752066115702, 0.7229752066115702, 0.8816528925619834, 0.8816528925619834, 0.8019834710743802, 0.8019834710743802, 0.8912396694214876, 0.8912396694214876, 0.7540495867768595, 0.7540495867768595, 0.8793388429752066, 0.8793388429752066, 0.8985123966942149, 0.8985123966942149, 0.8763636363636363, 0.8763636363636363, 0.7976859504132231, 0.7976859504132231, 0.8419834710743802, 0.8419834710743802, 0.8740495867768595, 0.8740495867768595, 0.8601652892561984, 0.8601652892561984, 0.7348760330578512, 0.7348760330578512, 0.7213223140495868, 0.7213223140495868, 0.8393388429752067, 0.8393388429752067, 0.7312396694214875, 0.7312396694214875, 0.7206611570247934, 0.7206611570247934, 0.7328925619834711, 0.7328925619834711, 0.7233057851239669, 0.7233057851239669, 0.7213223140495868, 0.7213223140495868, 0.7256198347107438, 0.7256198347107438, 0.7170247933884297, 0.7170247933884297, 0.7206611570247934, 0.7206611570247934, 0.7173553719008264, 0.7173553719008264, 0.7163636363636363, 0.7163636363636363, 0.7206611570247934, 0.7206611570247934, 0.7117355371900826, 0.7117355371900826, 0.7153719008264463, 0.7153719008264463, 0.7123966942148761, 0.7123966942148761, 0.7233057851239669, 0.7233057851239669, 0.8657851239669422, 0.8657851239669422, 0.7011570247933885, 0.7011570247933885, 0.8628099173553719, 0.8628099173553719, 0.704793388429752, 0.704793388429752, 0.8895867768595042, 0.8895867768595042, 0.8902479338842976, 0.8902479338842976, 0.687603305785124, 0.687603305785124, 0.7401652892561984, 0.7401652892561984, 0.8753719008264463, 0.8753719008264463, 0.8234710743801653, 0.8234710743801653, 0.7054545454545454, 0.7054545454545454, 0.7279338842975207, 0.7279338842975207, 0.7322314049586777, 0.7322314049586777, 0.7246280991735538, 0.7246280991735538, 0.7173553719008264, 0.7173553719008264, 0.7246280991735538, 0.7246280991735538, 0.725289256198347, 0.725289256198347, 0.7203305785123967, 0.7203305785123967, 0.7213223140495868, 0.7213223140495868, 0.7246280991735538, 0.7246280991735538, 0.72, 0.72, 0.71900826446281, 0.71900826446281, 0.72, 0.72, 0.7163636363636363, 0.7163636363636363, 0.7180165289256198, 0.7180165289256198, 0.7150413223140496, 0.7150413223140496, 0.7163636363636363, 0.7163636363636363, 0.7133884297520661, 0.7133884297520661, 0.7127272727272728, 0.7127272727272728, 0.7127272727272728, 0.7127272727272728, 0.7186776859504133, 0.7186776859504133, 0.7173553719008264, 0.7173553719008264, 0.7143801652892562, 0.7143801652892562, 0.7239669421487603, 0.7239669421487603, 0.7094214876033058, 0.7094214876033058, 0.7266115702479339, 0.7266115702479339, 0.7150413223140496, 0.7150413223140496, 0.7193388429752066, 0.7193388429752066, 0.7209917355371901, 0.7209917355371901, 0.7143801652892562, 0.7143801652892562, 0.7193388429752066, 0.7193388429752066, 0.7130578512396695, 0.7130578512396695, 0.7163636363636363, 0.7163636363636363, 0.7120661157024794, 0.7120661157024794, 0.7123966942148761, 0.7123966942148761, 0.7110743801652892, 0.7110743801652892, 0.7107438016528925, 0.7107438016528925, 0.7114049586776859, 0.7114049586776859, 0.7087603305785124, 0.7087603305785124, 0.7090909090909091, 0.7090909090909091, 0.7090909090909091, 0.7090909090909091, 0.7203305785123967, 0.7203305785123967, 0.7282644628099173, 0.7282644628099173, 0.7209917355371901, 0.7209917355371901, 0.7170247933884297, 0.7170247933884297, 0.7160330578512397, 0.7160330578512397, 0.71900826446281, 0.71900826446281, 0.7213223140495868, 0.7213223140495868, 0.7104132231404958, 0.7104132231404958, 0.7209917355371901, 0.7209917355371901, 0.7137190082644628, 0.7137190082644628, 0.7130578512396695, 0.7130578512396695, 0.7160330578512397, 0.7160330578512397, 0.7110743801652892, 0.7110743801652892, 0.7143801652892562, 0.7143801652892562, 0.7104132231404958, 0.7104132231404958, 0.7123966942148761, 0.7123966942148761, 0.7104132231404958, 0.7104132231404958, 0.7123966942148761, 0.7123966942148761, 0.7127272727272728, 0.7127272727272728, 0.716694214876033, 0.716694214876033, 0.707107438016529, 0.707107438016529, 0.7203305785123967, 0.7203305785123967, 0.725289256198347, 0.725289256198347, 0.7130578512396695, 0.7130578512396695, 0.8419834710743802, 0.8419834710743802, 0.7206611570247934]
    d = [0.030111428875459506, 0.030111428875459506, 0.030267020594478215, 0.030267020594478215, 0.036858744717095576, 0.036858744717095576, 0.04699033030403046, 0.04699033030403046, 0.0446200082203276, 0.0446200082203276, 0.06141170683515214, 0.06141170683515214, 0.04757806490004797, 0.04757806490004797, 0.3153854602540774, 0.3153854602540774, 0.3553865242856339, 0.3553865242856339, 0.3704068566849905, 0.3704068566849905, 0.44963812451914514, 0.44963812451914514, 0.4624540987624632, 0.4624540987624632, 0.4018565995348763, 0.4018565995348763, 0.4039425421734443, 0.4039425421734443, 0.46448016304699097, 0.46448016304699097, 0.4924280976610572, 0.4924280976610572, 0.5173850023714989, 0.5173850023714989, 0.5315518254417727, 0.5315518254417727, 0.5460294993264372, 0.5460294993264372, 0.5635321377117462, 0.5635321377117462, 0.570404412904578, 0.570404412904578, 0.5705092045737152, 0.5705092045737152, 0.5853237941091408, 0.5853237941091408, 0.5870936803725676, 0.5870936803725676, 0.5846865272087334, 0.5846865272087334, 0.5800112346626283, 0.5800112346626283, 0.5742559406474991, 0.5742559406474991, 0.5626963833945816, 0.5626963833945816, 0.5691100037605834, 0.5691100037605834, 0.4103845014820148, 0.4103845014820148, 0.4583571817227155, 0.4583571817227155, 0.5420340363362034, 0.5420340363362034, 0.5188049520144936, 0.5188049520144936, 0.45295770923291584, 0.45295770923291584, 0.5203503230517914, 0.5203503230517914, 0.48355967580761333, 0.48355967580761333, 0.43670664774808293, 0.43670664774808293, 0.5098519541760771, 0.5098519541760771, 0.5485204273067541, 0.5485204273067541, 0.4768507699314416, 0.4768507699314416, 0.5440868566065179, 0.5440868566065179, 0.5713339735541109, 0.5713339735541109, 0.5439568086253359, 0.5439568086253359, 0.5507619003511672, 0.5507619003511672, 0.5289746426049222, 0.5289746426049222, 0.5794012043781095, 0.5794012043781095, 0.5330311282342528, 0.5330311282342528, 0.5467918455969087, 0.5467918455969087, 0.5661380884369922, 0.5661380884369922, 0.5531897349898584, 0.5531897349898584, 0.5460327143054925, 0.5460327143054925, 0.5427312223285359, 0.5427312223285359, 0.5545469439564056, 0.5545469439564056, 0.5475226434574026, 0.5475226434574026, 0.5203674559652078, 0.5203674559652078, 0.538474395219323, 0.538474395219323, 0.5103855532030582, 0.5103855532030582, 0.5042109462864771, 0.5042109462864771, 0.49765394396926, 0.49765394396926, 0.5033628297636275, 0.5033628297636275, 0.49697132696836527, 0.49697132696836527, 0.5167330692751216, 0.5167330692751216, 0.2759328784948487, 0.2759328784948487, 0.49570740481713726, 0.49570740481713726, 0.43349171947377274, 0.43349171947377274, 0.4412533663122545, 0.4412533663122545, 0.5573579010548041, 0.5573579010548041, 0.3747863233168458, 0.3747863233168458, 0.46955228287279804, 0.46955228287279804, 0.5506324285084238, 0.5506324285084238, 0.5795431695728638, 0.5795431695728638, 0.5613493013660518, 0.5613493013660518, 0.5148852842926646, 0.5148852842926646, 0.4584838317620395, 0.4584838317620395, 0.49811763938343245, 0.49811763938343245, 0.5428789760499444, 0.5428789760499444, 0.540963487682198, 0.540963487682198, 0.5111644502000621, 0.5111644502000621, 0.4886195851040947, 0.4886195851040947, 0.5185982506157586, 0.5185982506157586, 0.5208814524101636, 0.5208814524101636, 0.47137900832872365, 0.47137900832872365, 0.47983774072740776, 0.47983774072740776, 0.5128960735363229, 0.5128960735363229, 0.45519349109534385, 0.45519349109534385, 0.48239452107186814, 0.48239452107186814, 0.4865770144865021, 0.4865770144865021, 0.49874222978499255, 0.49874222978499255, 0.5074291587881176, 0.5074291587881176, 0.5005816778427663, 0.5005816778427663, 0.4974854370158062, 0.4974854370158062, 0.5020662205871255, 0.5020662205871255, 0.5036457469513189, 0.5036457469513189, 0.5125612330970769, 0.5125612330970769, 0.5693506697948345, 0.5693506697948345, 0.49050451573733406, 0.49050451573733406, 0.48717604311249246, 0.48717604311249246, 0.4809972088649481, 0.4809972088649481, 0.48911628081550707, 0.48911628081550707, 0.5006608128275066, 0.5006608128275066, 0.6123512319954706, 0.6123512319954706, 0.4607582885805642, 0.4607582885805642, 0.625985869945698, 0.625985869945698, 0.44376111321345735, 0.44376111321345735, 0.6159231499629243, 0.6159231499629243, 0.5915305708064186, 0.5915305708064186, 0.4766932399303632, 0.4766932399303632, 0.5749113016204731, 0.5749113016204731, 0.5124703652429713, 0.5124703652429713, 0.4877393129060837, 0.4877393129060837, 0.5154982452837407, 0.5154982452837407, 0.5032705483655993, 0.5032705483655993, 0.4906142816397056, 0.4906142816397056, 0.5019085218301952, 0.5019085218301952, 0.4899780898926966, 0.4899780898926966, 0.48941441429227533, 0.48941441429227533, 0.48776154873939465, 0.48776154873939465, 0.488749123073, 0.488749123073, 0.4926166434869384, 0.4926166434869384, 0.48268381054063747, 0.48268381054063747, 0.47917119058018, 0.47917119058018, 0.6298201813462704, 0.6298201813462704, 0.5180126480612787, 0.5180126480612787, 0.6518971969202217, 0.6518971969202217, 0.4698152037290608, 0.4698152037290608, 0.6306293513244541, 0.6306293513244541, 0.6739839630972212, 0.6739839630972212, 0.6257275220894314, 0.6257275220894314, 0.498602319413092, 0.498602319413092, 0.5552143916332581, 0.5552143916332581, 0.6206086668512274, 0.6206086668512274, 0.5953636960471154, 0.5953636960471154, 0.4876533835974482, 0.4876533835974482, 0.5049582056853774, 0.5049582056853774, 0.5718347277328142, 0.5718347277328142, 0.5040844875694036, 0.5040844875694036, 0.49537206061287226, 0.49537206061287226, 0.529539061997612, 0.529539061997612, 0.5059143791437505, 0.5059143791437505, 0.4958872923322028, 0.4958872923322028, 0.5116258011645158, 0.5116258011645158, 0.49382616597329915, 0.49382616597329915, 0.4949676515117116, 0.4949676515117116, 0.494689234361158, 0.494689234361158, 0.48921964556152364, 0.48921964556152364, 0.503137048719419, 0.503137048719419, 0.48227991589513897, 0.48227991589513897, 0.48800416839593797, 0.48800416839593797, 0.48132518225934273, 0.48132518225934273, 0.5069009548003846, 0.5069009548003846, 0.6128154855398309, 0.6128154855398309, 0.42724500957928313, 0.42724500957928313, 0.5794724492861378, 0.5794724492861378, 0.37954632942443467, 0.37954632942443467, 0.6474969592719318, 0.6474969592719318, 0.6567396833060225, 0.6567396833060225, 0.4115789392382905, 0.4115789392382905, 0.5168594196383646, 0.5168594196383646, 0.6329272030366069, 0.6329272030366069, 0.5696427062868891, 0.5696427062868891, 0.4490437715172829, 0.4490437715172829, 0.5059966727527279, 0.5059966727527279, 0.5251569352450411, 0.5251569352450411, 0.5116713144603934, 0.5116713144603934, 0.4880895021174621, 0.4880895021174621, 0.5101089609415213, 0.5101089609415213, 0.5151793017286982, 0.5151793017286982, 0.503346860640075, 0.503346860640075, 0.5043939977685623, 0.5043939977685623, 0.5170774627981162, 0.5170774627981162, 0.5019631543193968, 0.5019631543193968, 0.5027995463100138, 0.5027995463100138, 0.5053832974285073, 0.5053832974285073, 0.4923445220323817, 0.4923445220323817, 0.49797119866007733, 0.49797119866007733, 0.4919138745986624, 0.4919138745986624, 0.4931749262896941, 0.4931749262896941, 0.4880304855159377, 0.4880304855159377, 0.4877298052754194, 0.4877298052754194, 0.48812614686214745, 0.48812614686214745, 0.48473038207425007, 0.48473038207425007, 0.5008939588483193, 0.5008939588483193, 0.4857178280254021, 0.4857178280254021, 0.5128807148393342, 0.5128807148393342, 0.4735994866210537, 0.4735994866210537, 0.523344699101372, 0.523344699101372, 0.4844328819158321, 0.4844328819158321, 0.5021887801021222, 0.5021887801021222, 0.5072759305542504, 0.5072759305542504, 0.489227710953091, 0.489227710953091, 0.5090068136060245, 0.5090068136060245, 0.48934206621831683, 0.48934206621831683, 0.5004546317866172, 0.5004546317866172, 0.489767567327093, 0.489767567327093, 0.4907604947550634, 0.4907604947550634, 0.4856253209522178, 0.4856253209522178, 0.4864931537407362, 0.4864931537407362, 0.48578331274462466, 0.48578331274462466, 0.48036903116403884, 0.48036903116403884, 0.4794117620888091, 0.4794117620888091, 0.47972078215356134, 0.47972078215356134, 0.49059704816117905, 0.49059704816117905, 0.4815939195291967, 0.4815939195291967, 0.5112079978497549, 0.5112079978497549, 0.5076780864359011, 0.5076780864359011, 0.49076071031442653, 0.49076071031442653, 0.5085605500049254, 0.5085605500049254, 0.512243164005848, 0.512243164005848, 0.4835826233033783, 0.4835826233033783, 0.5126509855837915, 0.5126509855837915, 0.4932906615453101, 0.4932906615453101, 0.4923862310491992, 0.4923862310491992, 0.509932627295821, 0.509932627295821, 0.48871404737561364, 0.48871404737561364, 0.502352541333551, 0.502352541333551, 0.48729165212701814, 0.48729165212701814, 0.4928789425350389, 0.4928789425350389, 0.48587782058771634, 0.48587782058771634, 0.49299279145606073, 0.49299279145606073, 0.4938162269027193, 0.4938162269027193, 0.5111757828270833, 0.5111757828270833, 0.4759204141896811, 0.4759204141896811, 0.5130370177116077, 0.5130370177116077, 0.5139100506087241, 0.5139100506087241, 0.48903375141148836, 0.48903375141148836, 0.590094629236463, 0.590094629236463, 0.4999047929729064]

    plot_loss([a,b,c,d],dim_num=4)